CPP=g++
SYSLIB  = -lz -l TreePlayer -lMathMore
ROOTLIB = `root-config --cflags --libs`
CXXFLAG = -O3 -I `root-config --incdir`

PROG = exec_LoopOnData

OBJ = HiRAReader.o EnergyLossModule.o nuclear_masses.o HiRACsICalibration.o HTHiRARootEvent.o
DIC = HTHiRADict.cxx
DIC_PCM = HTHiRADict_rdict.pcm

INCLUDES := -I./include/

CXXFLAG  += $(INCLUDES) -std=c++11 -fPIC -O3 -Wall

all: $(PROG)

$(PROG): $(SOURCE) $(OBJ) $(DIC)
	$(CPP) $(CXXFLAG) -o ${@} ${@}.cpp $(OBJ) $(DIC) $(SYSLIB) $(ROOTLIB)

HTHiRADict.cxx: include/HTHiRARootEvent.h include/HTHiRALinkDef.h
	rootcling -f HTHiRADict.cxx -p $(INCLUDES) $^

HTHiRARootEvent.o: HTHiRARootEvent.cxx include/HTHiRARootEvent.h
	$(CPP) $(CXXFLAG) -c HTHiRARootEvent.cxx $(SYSLIB) $(ROOTLIB)

HiRAReader.o: HiRAReader.cpp HTHiRADict.cxx include/HiRAReader.h
	$(CPP) $(CXXFLAG) -c HiRAReader.cpp HTHiRADict.cxx $(SYSLIB) $(ROOTLIB)

EnergyLossModule.o: EnergyLossModule.cpp include/EnergyLossModule.h
	$(CPP) $(CXXFLAG) -c EnergyLossModule.cpp $(SYSLIB) $(ROOTLIB)

nuclear_masses.o: Nuclear_Masses/nuclear_masses.cc include/nuclear_masses.h
	$(CPP) $(CXXFLAG) -c Nuclear_Masses/nuclear_masses.cc $(SYSLIB) $(ROOTLIB)

HiRACsICalibration.o: HiRACsICalibration.cpp include/HiRACsICalibration.h
	$(CPP) $(CXXFLAG) -c HiRACsICalibration.cpp $(SYSLIB) $(ROOTLIB)

clean:
	rm $(PROG) $(OBJ) $(DIC) $(DIC_PCM)
